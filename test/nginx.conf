user  root;
worker_processes  2;
error_log  logs/error.log  debug;
worker_shutdown_timeout 10s;

events {
    multi_accept        on;
    use                 epoll;
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  text/html;
    keepalive_timeout  75s;

    upstream http_server1 {
        server 127.0.0.1:8080 max_fails=0 fail_timeout=0;
    }

    upstream http_server2 {
        server 127.0.0.1:8081 max_fails=0 fail_timeout=0;
    }

    server {
        server_name _;
        listen 80 default_server reuseport backlog=65535;

        location / {
            return 503;
        }
    }

    server {
        server_name foo1.example.com;
        listen 80;

	    location /foo1 {
	        proxy_pass http://http_server1;
	    }
    }

    server {
        server_name  foo2.example.com;
        listen 80;

	    location /foo2 {
	        proxy_pass http://http_server2;
	    }
    }

}
